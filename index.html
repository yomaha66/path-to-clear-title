<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Path to Clear Title: Louisiana Tax Sale Forfeiture</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
                max-height: 400px;
            }
        }
        .flow-arrow {
            font-size: 2rem;
            line-height: 1;
            color: #4195E7;
            transform: translateY(2rem);
        }
        .flow-arrow-horizontal {
            font-size: 2rem;
            line-height: 1;
            color: #4195E7;
            margin: 0 1rem;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            display: flex;
            flex-direction: column;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .text-main { color: #00449E; }
        .text-accent { color: #0075D8; }
        .bg-main { background-color: #00449E; }
        .bg-accent { background-color: #EBF4FF; }
        .gemini-btn {
            background-color: #0075D8;
            color: white;
            font-weight: bold;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.3s;
            cursor: pointer;
        }
        .gemini-btn:hover {
            background-color: #00449E;
        }
        .gemini-btn:disabled {
            background-color: #90b3d1;
            cursor: not-allowed;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #0075D8;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .legal-term {
            border-bottom: 2px dotted #0075D8;
            cursor: pointer;
            font-weight: 600;
        }
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-black text-main mb-2">The Path to Clear Title</h1>
            <p class="text-xl md:text-2xl text-accent font-semibold">Understanding Property Forfeiture in Louisiana Tax Sales</p>
        </header>

        <section id="timeline" class="mb-16">
            <h2 class="text-3xl font-bold text-main text-center mb-8">The Chain of Events</h2>
            <div class="flex flex-col md:flex-row justify-center items-center space-y-4 md:space-y-0 md:space-x-4">
                <div class="card text-center w-full md:w-1/5">
                    <p class="text-2xl font-bold text-accent">①</p>
                    <h3 class="font-bold mt-2">Initial Default</h3>
                    <p class="text-sm">Company A fails to pay property taxes.</p>
                </div>
                <div class="flow-arrow md:flow-arrow-horizontal">→</div>
                <div class="card text-center w-full md:w-1/5 bg-accent">
                    <p class="text-2xl font-bold text-main">②</p>
                    <h3 class="font-bold mt-2">First Tax Sale</h3>
                    <p class="text-sm">Company B pays taxes for 2014-2020, acquiring a 1% "Tax Sale Title."</p>
                </div>
                <div class="flow-arrow md:flow-arrow-horizontal">→</div>
                <div class="card text-center w-full md:w-1/5">
                    <p class="text-2xl font-bold text-red-500">③</p>
                    <h3 class="font-bold mt-2">Second Default</h3>
                    <p class="text-sm">Company B fails to pay the 2021 taxes, breaching its <span class="legal-term" data-term="Statutory Duty">Statutory Duty</span>.</p>
                </div>
                <div class="flow-arrow md:flow-arrow-horizontal">→</div>
                <div class="card text-center w-full md:w-1/5 bg-accent">
                    <p class="text-2xl font-bold text-main">④</p>
                    <h3 class="font-bold mt-2">Second Tax Sale</h3>
                    <p class="text-sm">You purchase the tax deed for the 2021 delinquency.</p>
                </div>
                 <div class="flow-arrow md:flow-arrow-horizontal">→</div>
                <div class="card text-center w-full md:w-1/5">
                    <p class="text-2xl font-bold text-green-600">⑤</p>
                    <h3 class="font-bold mt-2"><span class="legal-term" data-term="Quiet Title">Quiet Title</span></h3>
                    <p class="text-sm">After the 3-year redemption period expires, you file suit to confirm full ownership.</p>
                </div>
            </div>
        </section>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">

            <section id="duty" class="card md:col-span-2">
                <h2 class="text-3xl font-bold text-main text-center mb-6">The Unbreakable Obligation of a Tax Purchaser</h2>
                <p class="text-center max-w-3xl mx-auto mb-8">Under Louisiana Revised Statute 47:2161, acquiring a "Tax Sale Title" is not a passive investment. It imposes a clear, non-negotiable legal duty on the purchaser to pay all subsequent property taxes until the property is redeemed. This duty is the foundation of the system.</p>
            </section>
            
            <section id="gemini-features" class="card md:col-span-2 bg-accent">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start">
                    <div class="text-center">
                        <h2 class="text-2xl font-bold text-main mb-4">Generate a Legal Rebuttal ✨</h2>
                        <p class="mb-6">Need to respond to Company B's claim? Click to generate a professional draft letter based on the legal principles outlined here.</p>
                        <button id="generateLetterBtn" class="gemini-btn">✨ Draft Response</button>
                    </div>
                    <div class="text-center">
                        <h2 class="text-2xl font-bold text-main mb-4">Case Law Research Assistant ✨</h2>
                        <p class="mb-6">Find relevant Louisiana court cases that support your position. This tool uses Google Search to find and summarize legal precedents.</p>
                        <button id="findCaseLawBtn" class="gemini-btn">✨ Find Case Law</button>
                    </div>
                </div>
                <div id="geminiLoader" class="hidden"></div>
                <div id="geminiOutput" class="hidden mt-6 p-6 bg-white rounded-lg border prose max-w-none"></div>
                <p class="text-xs text-gray-500 mt-4 text-center">Note: AI-generated content is for informational purposes and is not legal advice. Consult with a qualified attorney.</p>
            </section>

            <section id="redemption" class="card">
                <h2 class="text-2xl font-bold text-main text-center mb-4">Company B's Missed Opportunity</h2>
                <p class="text-center mb-6">The law provided Company B with a single, powerful remedy: the <span class="legal-term" data-term="Right of Redemption">right of redemption</span>. For three years after your purchase, it could have redeemed the property. It failed to act.</p>
                <div class="chart-container">
                    <canvas id="redemptionChart"></canvas>
                </div>
                 <p class="text-center mt-4 text-sm font-semibold text-accent">This failure to redeem constitutes a forfeiture of its legal remedy.</p>
            </section>

            <section id="unjust-enrichment" class="card">
                <h2 class="text-2xl font-bold text-main text-center mb-4">Why "<span class="legal-term" data-term="Unjust Enrichment">Unjust Enrichment</span>" Fails</h2>
                <p class="text-center mb-6">Company B's claim relies on an equitable doctrine, but this is barred when specific laws already exist.</p>
                <ul class="space-y-4 text-lg">
                    <li class="flex items-center"><span class="text-red-500 text-2xl mr-3 font-bold">❌</span> **Absence of Justification:** Your enrichment is justified by the tax sale laws.</li>
                    <li class="flex items-center"><span class="text-red-500 text-2xl mr-3 font-bold">❌</span> **<span class="legal-term" data-term="Subsidiarity Rule">Subsidiarity Rule</span>:** This claim is barred because Company B HAD another remedy: redemption.</li>
                </ul>
            </section>

             <section id="remedies" class="card md:col-span-2">
                <h2 class="text-3xl font-bold text-main text-center mb-4">Comparing Legal Options in a Quiet Title Action</h2>
                <p class="text-center max-w-3xl mx-auto mb-8">When you filed the quiet title suit, the law gave Company B a final, specific path to challenge your title. Demanding reimbursement is not a valid response.</p>
                <div class="chart-container h-96 max-h-[450px]">
                    <canvas id="remedyChart"></canvas>
                </div>
             </section>

        </div>

        <footer class="text-center mt-16 pt-8 border-t-2 border-blue-200">
             <h2 class="text-3xl font-black text-main">Diligence is Rewarded. Default has Consequences.</h2>
             <p class="text-lg text-accent mt-2 max-w-4xl mx-auto">The Louisiana tax sale framework protects the diligent purchaser. Company B's loss is the direct result of its own failure to follow the law. Its claim for reimbursement is unsupported by statute and barred by the principles of equity.</p>
        </footer>

    </div>
    
    <div id="termModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 id="modalTerm" class="text-2xl font-bold text-main mb-4"></h3>
            <div id="modalLoader" class="loader"></div>
            <p id="modalDefinition"></p>
            <button id="closeModalBtn" class="gemini-btn mt-6">Close</button>
        </div>
    </div>

    <script>
        const wrapLabel = (label) => {
            const maxLen = 16;
            if (label.length <= maxLen) return label;
            const words = label.split(' ');
            let lines = [];
            let currentLine = '';
            for (const word of words) {
                if ((currentLine + ' ' + word).length > maxLen && currentLine.length > 0) {
                    lines.push(currentLine);
                    currentLine = word;
                } else {
                    currentLine = currentLine ? currentLine + ' ' + word : word;
                }
            }
            lines.push(currentLine);
            return lines;
        };

        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
                return label.join(' ');
            }
            return label;
        };

        const brilliantBlues = {
            main: '#00449E',
            secondary: '#0075D8',
            accent: '#4195E7',
            light: '#8AC3F3',
            red: '#E53E3E',
            green: '#38A169'
        };

        const redemptionCtx = document.getElementById('redemptionChart').getContext('2d');
        new Chart(redemptionCtx, {
            type: 'doughnut',
            data: {
                labels: ['Redemption Opportunity Missed', 'Opportunity Taken'],
                datasets: [{
                    label: 'Redemption Status',
                    data: [100, 0],
                    backgroundColor: [brilliantBlues.red, brilliantBlues.green],
                    borderColor: '#ffffff',
                    borderWidth: 4,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '70%',
                plugins: {
                    legend: { display: false },
                    tooltip: { callbacks: { title: tooltipTitleCallback } },
                    title: { display: true, text: '3-Year Redemption Window', font: { size: 18, weight: 'bold' }, color: brilliantBlues.main, padding: { top: 10, bottom: 20 } }
                }
            }
        });

        const remedyCtx = document.getElementById('remedyChart').getContext('2d');
        new Chart(remedyCtx, {
            type: 'bar',
            data: {
                labels: [wrapLabel('Annul User\'s Tax Sale (Valid Legal Challenge)'), wrapLabel('Demand Reimbursement (Invalid Claim)')],
                datasets: [{
                    label: 'Legal Validity',
                    data: [100, 5],
                    backgroundColor: [brilliantBlues.green, brilliantBlues.red],
                    borderWidth: 1,
                    barPercentage: 0.5,
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { beginAtZero: true, ticks: { callback: (value) => value + '%', color: brilliantBlues.main }, grid: { display: false } },
                    y: { ticks: { color: brilliantBlues.main, font: { size: 14 } }, grid: { display: false } }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: { callbacks: { title: tooltipTitleCallback, label: (context) => context.dataIndex === 0 ? 'Valid, if grounds exist' : 'Invalid' } }
                }
            }
        });
        
        const generateLetterBtn = document.getElementById('generateLetterBtn');
        const findCaseLawBtn = document.getElementById('findCaseLawBtn');
        const geminiOutput = document.getElementById('geminiOutput');
        const geminiLoader = document.getElementById('geminiLoader');
        const termModal = document.getElementById('termModal');
        const modalTerm = document.getElementById('modalTerm');
        const modalDefinition = document.getElementById('modalDefinition');
        const modalLoader = document.getElementById('modalLoader');
        const closeModalBtn = document.getElementById('closeModalBtn');

        const allButtons = [generateLetterBtn, findCaseLawBtn];

        function toggleButtons(enable) {
            allButtons.forEach(btn => btn.disabled = !enable);
        }

        async function callGemini(prompt, useSearch = false) {
            geminiOutput.classList.add('hidden');
            geminiLoader.classList.remove('hidden');
            toggleButtons(false);

            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
            };
            if (useSearch) {
                payload.tools = [{ "google_search": {} }];
            }

            try {
                const text = await generateTextWithRetry(payload);
                geminiOutput.innerHTML = text.replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                geminiOutput.classList.remove('hidden');
            } catch (error) {
                console.error('Error calling Gemini:', error);
                geminiOutput.innerHTML = '<p class="text-red-500">An error occurred. Please try again later.</p>';
                geminiOutput.classList.remove('hidden');
            } finally {
                geminiLoader.classList.add('hidden');
                toggleButtons(true);
            }
        }

        generateLetterBtn.addEventListener('click', () => {
            const prompt = `You are a paralegal assistant. Draft a formal letter from a 2021 tax sale purchaser to "Company B", a prior (2014-2020) tax sale purchaser who is now demanding reimbursement after the property was sold again for taxes Company B failed to pay. The property is in Ouachita Parish, LA. The letter must be firm, professional, and clearly state that the claim for reimbursement is invalid based on these key points: 1. Company B breached its statutory duty under Louisiana Revised Statute 47:2161 by failing to pay the 2021 property taxes. 2. Company B's sole legal remedy to protect its investment was the right of redemption, which it failed to exercise within the three-year redemptive period following the 2021 tax sale. This failure resulted in the forfeiture of its interest. 3. The claim of "unjust enrichment" is legally barred by the subsidiarity rule, as a specific legal remedy (redemption) was available and not used. Conclude by stating that no reimbursement will be paid and the quiet title action will proceed. Do not offer legal advice, but structure this as a formal communication. Format the response using markdown for clarity.`;
            callGemini(prompt, false);
        });

        findCaseLawBtn.addEventListener('click', () => {
            const prompt = `Act as a legal research assistant. Find and briefly summarize 2-3 key Louisiana court cases relevant to a tax sale purchaser's duty to pay subsequent taxes and the inapplicability of unjust enrichment when a statutory remedy like redemption exists. For each case, provide the citation and a 2-3 sentence summary of its relevance.`;
            callGemini(prompt, true);
        });

        document.body.addEventListener('click', async (e) => {
            if (e.target.classList.contains('legal-term')) {
                const term = e.target.dataset.term;
                modalTerm.textContent = term;
                modalDefinition.textContent = '';
                modalLoader.style.display = 'block';
                termModal.classList.remove('hidden');

                const prompt = `Explain the legal term "${term}" in simple, easy-to-understand language for a non-lawyer. Keep it concise (2-4 sentences).`;
                const payload = { contents: [{ parts: [{ text: prompt }] }] };

                try {
                    const definition = await generateTextWithRetry(payload);
                    modalDefinition.textContent = definition;
                } catch (error) {
                    modalDefinition.textContent = 'Could not load definition.';
                } finally {
                    modalLoader.style.display = 'none';
                }
            }
        });

        closeModalBtn.addEventListener('click', () => termModal.classList.add('hidden'));
        termModal.addEventListener('click', (e) => {
            if (e.target === termModal) {
                termModal.classList.add('hidden');
            }
        });
        
        async function generateTextWithRetry(payload, maxRetries = 3) {
            const apiKey = ""; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            
            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) throw new Error(`API request failed with status ${response.status}`);

                    const result = await response.json();
                    if (result.candidates?.[0]?.content?.parts?.[0]?.text) {
                        return result.candidates[0].content.parts[0].text;
                    } else {
                        throw new Error('Invalid response structure from API');
                    }
                } catch (error) {
                    if (i === maxRetries - 1) throw error;
                    await new Promise(res => setTimeout(res, Math.pow(2, i) * 1000));
                }
            }
        }
    </script>
</body>
</html>
